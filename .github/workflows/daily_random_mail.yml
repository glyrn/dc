name: æ¯æ—¥éšæœºå€¼ï¼†æ‹çˆ±çºªå¿µé‚®ä»¶ï¼ˆ21ç‚¹Â±10åˆ†ï¼‰

on:
  schedule:
    - cron: '50 12 * * *'  # UTC 12:50 â†’ æœ¬åœ° 20:50

jobs:
  send_random_email:
    runs-on: ubuntu-latest
    steps:
      - name: éšæœºç­‰å¾…ï¼ˆÂ±10 åˆ†é’Ÿï¼‰
        run: |
          DELAY=$(( RANDOM % 1200 ))
          echo "â±ï¸ ç¡çœ  ${DELAY} ç§’â€¦"
          sleep $DELAY

      - name: è®¡ç®—éšæœºå€¼
        run: |
          VALUE=$(( RANDOM % 10000 ))
          echo "RANDOM_VALUE=$VALUE" >> $GITHUB_ENV

      - name: è®¡ç®—æ‹çˆ±å¤©æ•°
        env:
          # è¿™é‡Œå¡«ä½ ä»¬æ­£å¼åœ¨ä¸€èµ·çš„æ—¥æœŸï¼ˆYYYY-MM-DDï¼‰
          START_DATE: '2025-02-14'
        run: |
          # ç”¨ Linux date ç®—ç§’å·®å†é™¤ä»¥ 86400
          now_ts=$(date +%s)
          start_ts=$(date -d "$START_DATE" +%s)
          days=$(( (now_ts - start_ts) / 86400 ))
          echo "daysDiff=$days" >> $GITHUB_ENV

      - name: å‘é€é‚®ä»¶é€šçŸ¥
        uses: dawidd6/action-send-mail@v3
        with:
          server_address: ${{ secrets.SMTP_SERVER }}
          server_port:    ${{ secrets.SMTP_PORT }}
          username:       ${{ secrets.SMTP_USER }}
          password:       ${{ secrets.SMTP_PASS }}
          subject:        "ğŸ’Œ æ¯æ—¥éšæœºï¼†çºªå¿µæ—¥é€šçŸ¥"
          to:             goree.gly@gmail.com, 2028282676@qq.com
          from:           "GitHub Actions <${{ secrets.SMTP_USER }}>"
          body: |
            æ™šä¸Šå¥½ï½  
            ä»Šå¤©æ˜¯æˆ‘ä»¬æ‹çˆ±çš„ç¬¬ ${{ env.daysDiff }} å¤©å•¦ï¼â¤ï¸  
            å¿«å»è®°å½•ä»Šå¤©å‘ç”Ÿçš„äº‹æƒ…å§ï¼
            ğŸ‘‰ https://flisa.love.goree.tech
          
